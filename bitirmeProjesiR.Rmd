---
title: "Kariyer.net sitesi üzerinden çekilen 'istatistik' anahtar kelimeli ilanların analiz edilmesi"
author: 'Fatih Ekici'
output: html_notebook
---

```{r}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE
)
```



# Giriş

Kariyer.net üzerindeki ilanları python üzerinde selenium kütüphanesi ile çektik.Daha sonrasında excel üzerinden el ile veri analitiği ile alakasız veya istatistik mezunlarının girme şansı olmayan/girmek istemeyeceği ilanları düşürdük.Toplam veri sayısı 717 den 498 adet ilana düşürülmüştür. Bu işlemin yapılma sebebi +400 adet olan eşsiz pozisyon isimlerini daha kolay bir biçimde üst gruplara alabilmek ve daha tutarlı sonuçlar elde etmektir.

Buna ek olarak **pozisyon kısa** adı altında ilanlar belirli başlı niteliklere göre gruplandırılmıştır.

1.  veri analisti(iş zekası, veri analitiği, veri bilimci ,dijital reklamcılık sektör veya tittlelarına aitilanlar)

2.  finans analisti(finans sektörü hakkında bilgi gerektiren analist pozisyonları)

3.  develoaper(herhangi bir sektörde yazılım-it-bilgi işlem tarafındaki pozisyonlar

4.  iş analisti(finans analistine benzer şekilde genel anlamda yapılan iş ile alakalı analist pozisyonuna sahip pozisyonlar)

5.  insan kaynaklari (çoğunlukla ik işleri olmak üzere az sayıda personel ile ilgilenen pozisyonlar

6.  ticaret uzmanı(çoğunlukla evrak işleri, ithalat, ihracat ve satış pozisyonlarında uzmanlık gösteren pozisyonlar)

7.  Muhasebe

Bazı ilanlar pek çok pozisyona yakın davranmasından dolayı en yakın seçenek tercih edilmiştir.

# Tanımlayıcı bilgiler

```{r librarys}

library(readr)
library(readxl)
library(tm)
library(htmltools)
library("gridExtra")
library(tidyverse)
library(arsenal)
library("cowplot")
```


```{r}
mainDF <- read_excel("mainDF.xlsx")
mainDF<-unique(mainDF)
```

## Kaç farklı pozisyon vardır ve en çok tekrar edenler hangileridir?

Toplam `r length(unique(mainDF$pozisyon))` adet essiz isimli pozisyon bulunmaktadir.




```{r}
mainDF %>% 
  group_by(pozisyon) %>% 
  summarise(frekans=n()) %>%
  arrange(-frekans) %>% 
  slice(1:10) %>% 
  kableExtra::kable()

```

Görüldüğü gibi frekans sayıları benzer işlerin farklı sayılarla belirtilmesi sebebiyle azdır.Kısaltılmış ilan sayılarını inceleyelim.
```{r}
mainDF %>% 
  group_by(pozisyon_kisa) %>% 
  summarise(frekans=n()) %>% 
  arrange(-frekans) %>%
  rename(`indirgenmiş pozisyon`=pozisyon_kisa)%>%
  kableExtra::kable()
```


```{r}
mainDF %>%
  group_by(pozisyon_kisa) %>%
  summarise(frekans=n()) %>%
  arrange(-frekans) %>% 
  rename(`indirgenmiş pozisyon`=pozisyon_kisa) %>%
  ###plot asamasi
  ggplot(.,aes(x=reorder(`indirgenmiş pozisyon`, -frekans),y=frekans))+
  geom_bar(stat = "identity",col='white',fill='steelblue')+
  labs(x='pozisyonlar',
  title ='indirgenmiş ilanların frekansları tablosu')+
  theme_classic()


```
Beklenildiği üzere istatistik pozisyonlarında analist pozisyonların ön sıralarda olduğunu diğer meslek dallarında daha az ön planda olduğunu görmekteyiz. Finans sektörünün tek başına yüksek miktarda analist barındırdığı görülebilmektedir.

Bu kısım indirgemenin bir yan etkisi olarak net yorumlarda bulunmamızı engellemektedir. Bu sebeple sektör ve departmanları incelemek iş ilanları hakkında daha iyi bilgi sahibi olmamızı sağlar.


## Departman ve sektörel dağılım 

Kariyer.net ilanlara ait sektör ve departman bilgilerini de sunmakta, bu sayede iş ilanlarının hangi sektör ve departmanda daha çok yoğunlaştığını inceleyelim.

```{r}
mainDF %>% group_by(`Departman:`) %>% mutate(`Departman:`=tolower(`Departman:`)) %>% summarise(frekans=n()) %>% arrange(-frekans) %>% filter(frekans>5)->freqDepartmanDF

mainDF %>%
  group_by(`Firma Sektörü:`) %>%
  mutate(`Firma Sektörü:` = tolower(`Firma Sektörü:`))  %>%
  select(`Firma Sektörü:`) %>%
  summarise(frekans = n()) %>%
  arrange(-frekans) %>%
  filter(frekans >5) ->freqSektorDF
```


```{r,results='asis'}
knitr::kable(freqDepartmanDF,
             caption = '**Departman ait frekans tablosu**')

knitr::kable(freqSektorDF,
             caption = '**Sektörlere ait frekans tablosu**')
```


```{r}
mainDF %>% 
  group_by(`Departman:`) %>%
  mutate(`Departman:`=tolower(`Departman:`)) %>%
  summarise(frekans=n()) %>% arrange(-frekans) %>%
  filter(frekans>5) %>%
  ggplot(.,aes(x=reorder(`Departman:`, frekans),y=frekans))+
  geom_bar(stat = "identity",col='white',fill='steelblue')+
  labs(x='Deparmanlar',title= 'En az 5 pozisyona sahip departmanlar')+
  theme_classic()+
  coord_flip()->departmanPlot

freqSektorDF %>%
  mutate(`Firma Sektörü:`=ifelse(is.na(`Firma Sektörü:`),'bilinmiyor',`Firma Sektörü:`)) %>% 
  ggplot(.,aes(x=reorder(`Firma Sektörü:`, frekans),y=frekans))+
  geom_bar(stat = "identity",col='white',fill='steelblue')+
  labs(x='Sektörler',title= 'En az 5 pozisyona sahip departmanlar')+
  theme_classic()+
  coord_flip()->sektorPlot

cowplot::plot_grid(departmanPlot, sektorPlot, ncol = 2, nrow = 1)
```

Bilgi teknolojileri/it, planlama ve finans alanının en çok istihdam sağlanan departmanlardır .Sektörel anlamda ise bankacılık,perakende ve bilişim sektörü istatistik mezunlarına en çok istihdam sağlayan 3 sektördür. Bu sonuç, istatistik mezunlarının gün geçtikçe daha fazla bilgisayar ve yazılım teknolojileri ile iç içe çalıştğını göstermektedir.

Sektörel anlamda en çok istihdamın finans/bankacılık sektörü olduğu gözden kaçmamalıdır.

## iş ilanlarnın konumları

iş ilanlarının konumlarında istanbul'un avrupa ve anadolu yakaları 2 ayrı yer sayılırken kalan illerde herhangi bir değişiklik yapılmayacaktır.

Ayrıca bazı iş ilanlarında birden fazla konum olması, her bir bölgeyi ekstra sayabileceğimiz anlamına gelmektedir.Bu sebeple ilan sayısından daha fazla sayıda vilayet bulmuş oluruz.

```{r}
old1 <- "İ"
new1 <- "cgsıuocgsiou" 
```

```{r}
library(stringr)
parantezsil<-function(x)gsub("\\s*\\([^\\)]+\\)","",as.character(x))


gsub("İstanbul(Avr.)", "istanbul", mainDF$city , fixed=TRUE)%>%
  gsub("İstanbul(Asya)","istanbul",.,fixed =TRUE ) %>% 
  gsub("İzmir","izmir",.,fixed =TRUE ) %>% 
  parantezsil() %>%
  gsub(" ","",.,fixed = TRUE) %>% 
  strsplit(",") %>% 
  lapply(., function(x)x[!duplicated(x)]) %>% 
  unlist() %>% 
  gsub(" ","",.) %>% 
  tolower() %>%
  table() %>%
  data.frame() %>% 
  rename(il=1,frekans='Freq') %>% 
  arrange(-frekans)->ilFreqDF
    
```

```{r}
TUR[[6]] %>% data.frame() %>% rename('NAME_1'=1) %>%
  mutate(
    NAME_1 = tolower(NAME_1),
    NAME_1 = case_when(
      NAME_1 == 'eskisehir' ~ 'eskişehir',
      NAME_1 == 'k. Maras' ~ 'kahramanmaraş',
      NAME_1 == 'sanliurfa' ~ 'şanlıurfa',
      NAME_1 == 'eskisehir' ~ 'tekirdağ',
      NAME_1!=c('eskişehir','kahramanmaraş','şanlıurfa','tekirdağ')~NAME_1
    )) %>% pull(1)->TUR[[6]]

```

```{r}
fortify(TUR) -> TUR_for
id_and_cities_ist <- data_frame(id = rownames(TUR@data),
                                'il' = TUR@data$NAME_1) %>%
  left_join(ilFreqDF, by = "il") 
final_ist_map <- left_join(TUR_for, id_and_cities_ist, by = "id")
```

```{r}
library(mapproj)
ggplot(final_ist_map) +
  geom_polygon( aes(x = long, y = lat, group = group, fill = frekans),
                color = "grey") +
  coord_map() +
  theme_void() + 
  labs(title = "2021 haziran ayı istatistik mezunlarına uygun iş ilanlarının konumları",
       subtitle = paste0("Toplam çalışılabilir konum sayisi: ", sum(ilFreqDF$frekans)),
       caption = "Veri Kaynağı: kariyer.net") +
  scale_fill_distiller(palette = 'Reds',
                       direction = 1,
                         type = "seq",
                       name = "illere göre ilan frekansı",
                       limits = c(0,400), na.value = "white") +
  theme(plot.title = element_text(hjust = 0.05),
        plot.subtitle = element_text(hjust = 0.05))

```

iş ilanlarının çoğunluğu incelendiğinde ağırlıklı olarak istanbulun iş havuzunun çok yüksek bir kısmını barındırdığı görülebilir. Finans,it,arge sektörlerinin çoğunlukla istanbulda yoğunlaşması bu sonucun nihai sebebidir.
```{r}
gsub("İstanbul(Avr.)", "istanbul.avrupa", mainDF$city , fixed=TRUE)%>%
  gsub("İstanbul(Asya)","istanbul.asya",.,fixed =TRUE ) %>% 
  gsub("İzmir","izmir",.,fixed =TRUE ) %>% 
  parantezsil() %>%
  gsub(" ","",.,fixed = TRUE) %>% 
  strsplit(",") %>% 
  lapply(., function(x)x[!duplicated(x)]) %>% 
  unlist() %>% 
  gsub(" ","",.) %>% 
  tolower() %>%
  table() %>%
  data.frame() %>% 
  rename(il=1,frekans='Freq') %>% 
  arrange(-frekans)->ilIstanbulFreqDF
ilIstanbulFreqDF[1:2,] %>% kableExtra::kable()
```
Bununla beraber avrupa yakasının iş imkanı, asya yakasına göre 1,6 kat daha fazladır.Avrupa yakasında ikamet etmek iş bulma konusunda kolaylık veya avantaj sağlayabilir.

## Askerlik şartları

Askerlik durum bilgisinde yapıldı,muaf,tecilli,yapılmadı şeklinde 4 farklı kategori bulunmakta.Yapıldı ve muaf kesinlikle askere gitmeyen bir kişiyi ifade ettiği için bu 2 grubu yapıldı,tecilli ve yapılmadı ise beraber değerlendirecektir.

```{r}
one_hot<-function(df,col){
  dummy_list<-list(NA)
  unique(as.vector(as.matrix(df[col])))->lvls
  
  
  for(i in 1:length(lvls)){
    ifelse(as.vector(df[col]== lvls[i]),1,NA)->dummy_list[[i]]
    add_column(df, !!(lvls[i]) := dummy_list[[i]])->df
  }
  return(df)
}
```


```{r}
mainDF$`Askerlik Durumu:` %>% unique()
mainDF %>% select(`Askerlik Durumu:`) %>%
  mutate(`Askerlik Durumu:`=case_when(
  grepl('Yapılmadı|Tecilli',mainDF$`Askerlik Durumu:`)~'yapıldı-muaf',
  grepl('Muaf|Yapıldı',mainDF$`Askerlik Durumu:`)~'tecilli-yapılmadı',
  is.na(mainDF$`Askerlik Durumu:`)~NA_character_)) %>%
  group_by(`Askerlik Durumu:`) %>% 
  summarise(`Askelik Durumu`=n()) %>% 
  kableExtra::kable()
```

Veride askerlik bilgisine dair büyük bir kısımda herhangi bir bilgi girişi yapılmamıştır.Yinede ilanların büyük bir kısmında işverenin askerliğin makul bir tecil süresini hoş karşıladığını görmekteyiz.
**Revize not**:Bu kısım ilan içerikleri kısmından daha detaylı edinilebilir.

## Tecrübe

Pozisyonlar için gerekli olan tecrübe seviyesini inceleyelim.

```{r}
mainDF %>% select(`Tecrübe:`,pozisyon) %>% mutate(min=case_when(
  grepl("En az",mainDF$`Tecrübe:`)~str_extract(mainDF$`Tecrübe:`,'\\d+'),
  grepl("^\\d+",mainDF$`Tecrübe:`)~str_extract(mainDF$`Tecrübe:`,'^\\d+'),
  grepl('tecrübesiz|Tecrübesiz',mainDF$`Tecrübe:`)~"0"),
  max=case_when(
    grepl("En az",mainDF$`Tecrübe:`)~NA_character_,
    grepl('En çok',mainDF$`Tecrübe:`)~str_extract(mainDF$`Tecrübe:`,'\\d+'),
  grepl("^\\d+",mainDF$`Tecrübe:`)~(str_extract_all(mainDF$`Tecrübe:`,'\\d+') %>% 
    lapply(.,function(x){
  ifelse(length(x)>1,x[2],NA)}
) %>% unlist())
  )) ->tecrubeMinMaxDF
```


```{r}
ggplot(tecrubeMinMaxDF,aes(x=as.numeric(min)))+geom_density()+
  labs(x="Minimum Tecrübe Süresi",
       y="Yoğunluk",
       caption='Veri Kaynağı: kariyer.net\n 9eksik gozleme gore*')+
  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))
```

En çok aranan seviyenin mid level pozisyonlar olduğunu görülmüştür.
 `r tecrubeMinMaxDF %>% filter(min<5) %>% nrow` kişi yani 5 yıldan fazla tecrübeye sahip birisi ilanların ~%80'nine  başvuruda bulunabilir.

Maksimum tecrübe kıstasında yeterli veri olmaması sebebiyle analize dahil edilmemiştir.
### Yönetici pozisyonlar
İçerisinde yönetici,müdür,manager kelimelerinin geçtiği ilananlarının minimum tecrübe süresine göre yöneticiler için ortalama çalışma süresi
```{r}


tecrubeMinMaxDF[grepl('müdür|yönetici|manager',tolower(tecrubeMinMaxDF$pozisyon)),] %>% 
  ggplot(.,aes(x=as.numeric(min)))+geom_density()+
  labs(x="Minimum Tecrübe Süresi",
       y="Yoğunluk",
       caption='Veri Kaynağı: kariyer.net\n 9eksik gozleme gore*')+
  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))

```

İçerisinde **yönetici**,**müdür**,**manager** kelimelerinin geçtiği ilananlarının minimum tecrübe süresini incelendiğinde 3.yıldan itibaren yönetici pozisyonlarının yükselişe geçtiğini 5.yıldan itibaren ise zirveye yaklaştığını görmekteyiz. 
5.yılın iş hayatında dikey yükseliş yaşamak için uygun bir tecrübe süresi olduğunu görebiliriz.

# ilan içeriklerinin analiz edilmesi
Bu aşamada ilan içeriklerindeki hard skill'lerin bulunması ve benzer iş ilanlarının kümelenerek bu ilanlara ait becerilerde ne tür farklılıklar/benzerlikler olduğu analiz edilecektir.



